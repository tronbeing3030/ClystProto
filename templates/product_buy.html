<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clyst - Product Details</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../static/css/styles.css">
    <link rel="stylesheet" href="../static/css/product_page.css" />
  </head>
  <body>
    <!-- ===== NAVBAR ===== -->
    <nav id="topNav">
      <div class="nav">
      <div class="nav-left">
        <div class="hamburger" onclick="toggleMenu(event)">
          <span></span><span></span><span></span>
        </div>
        <a href="{{url_for('home')}}">Clyst</a>
      </div>

      <div class="nav-center" id="navLinks">
        <a href="{{url_for('home')}}">Community Feed</a>
        <a href="{{url_for('products_page')}}">Marketplace</a>
        {% if current_user.is_authenticated %}
        <a href="{{ url_for('logout') }}">Logout</a>
        {% else %}
        <a href="{{ url_for('login') }}">Login</a>
        <a href="{{ url_for('register') }}">Register</a>
        {% endif %}
      </div>

      <div class="nav-actions">
        {% if current_user.is_authenticated %}
        <a
          href="{{url_for('profile', id=current_user.id)}}"
          class="profile-btn"
          title="Profile"
        >
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path
              d="M12 12c2.7 0 4.8-2.1 4.8-4.8S14.7 2.4 12 2.4 7.2 4.5 7.2 7.2 9.3 12 12 12zm0 2.4c-3.2 0-9.6 1.6-9.6 4.8v2.4h19.2v-2.4c0-3.2-6.4-4.8-9.6-4.8z"
            />
          </svg>
        </a>
        {% endif %}
      </div>
    </div>
    <div class="mobile-menu" id="mobileMenu">
      <a href="{{url_for('home')}}">Community Feed</a>
      <a href="{{url_for('products_page')}}">Marketplace</a>
      {% if current_user.is_authenticated %}
      <a href="{{ url_for('logout') }}">Logout</a>
      {% else %}
      <a href="{{ url_for('login') }}">Login</a>
      <a href="{{ url_for('register') }}">Register</a>
      {% endif %}
    </div>
    </nav>


    <div class="container">
      <!-- Main Content -->
      <div class="post">
        <div class="post-info">
          {% if current_user.is_authenticated and current_user.id ==
          product.artist_id %}
          <button
            class="btn btn-danger product-delete-btn"
            onclick="if(confirm('Delete this product?')) window.location.href='{{ url_for('delete_posts', product_id=product.product_id) }}'"
            title="Delete Post"
          >
            <i class="fas fa-trash"></i>
          </button>
          {% endif %}

          <div class="product-header">
            <h1 class="product-title">{{ product.title }}</h1>
            <div class="product-price">Rs.{{ product.price }}</div>
          </div>
          <div class="item-desc">{{product.description}}</div>

          <!-- Product Meta -->
          <div class="product-meta">
            <div class="meta-item">
              <div class="meta-label">Added</div>
              <div class="meta-value">{{ product.created_at }}</div>
            </div>
            <div class="meta-item">
              <div class="meta-label">Category</div>
              <div class="meta-value">Artwork</div>
            </div>
          </div>

          <!-- Artist Information -->
          <div class="product-artist">
            <div class="artist">
              <div class="artist-avatar">
                {{ product.artist.name[0].upper() }}
              </div>
              <div class="artist-info">
                <h3>{{ product.artist.name }}</h3>
                <p>Artisan</p>
              </div>
            </div>
            <div class="view-artisan-btn">
              <a
                href="{{url_for('view_profile', user_id=product.artist.id)}}"
                class="btn-secondary"
                >View Artisan</a
              >
            </div>
          </div>

          <a
            href="javascript:void(0)"
            onclick="handlePurchase()"
            class="btn-primary"
            >Purchase</a
          >
          <div class="product-options">
            <button
              class="share-btn"
              onclick="copyToClipboard(window.location.host + '{{ url_for('product_buy', product_id=product.product_id) }}')"
            >
              <i class="fa-solid fa-link"></i>
            </button>
            <button
              class="btn say-aloud-btn"
              onclick="sayAloud({title: '{{ product.title }}', artist: '{{ product.artist.name }}', price: '{{ product.price }}', description: '{{ product.description | default('No description available') }}' })"
              title="Say Aloud"
            >
              <i class="fa-solid fa-volume-high"></i>
            </button>
          </div>
        </div>
        {% if product.img_url %}
        <div class="post-image">
          <img
            src="{{ product.img_url }}"
            alt="{{ product.title }}"
            class="product-image"
          />
        </div>
        {% endif %}
      </div>
    </div>

    <div id="google_translate_element" class="translate-element"></div>
    <button
      id="translateButton"
      onclick="googleTranslateElementInit()"
      class="translate-btn"
    >
      <i class="fa-solid fa-language"></i>
    </button>

    <script src="../static/js/app.js"></script>
    <script>
      function handlePurchase() {
        // Show a modal or redirect to payment gateway
        alert(
          "Payment gateway integration would go here!\n\nThis would typically redirect to:\n- Stripe\n- PayPal\n- Razorpay\n- Or other payment processors"
        );
      }
</script>
    <script
      type="text/javascript"
      src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
    ></script>
  </body>
</html>
